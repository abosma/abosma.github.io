(()=>{var r=class{constructor(){this.renderers=new Array;this.displayCanvas=document.querySelector("#canvas"),this.offscreenCanvas=document.createElement("canvas"),this.offscreenCanvas.width=this.displayCanvas.width,this.offscreenCanvas.height=this.displayCanvas.height,this.displayContext=this.displayCanvas.getContext("2d"),this.offscreenContext=this.offscreenCanvas.getContext("2d")}static getInstance(){return r.instance||(r.instance=new r),r.instance}addRenderer(e){this.renderers.indexOf(e)==-1&&this.renderers.push(e)}update(e){this.clearScreen();for(let t=this.renderers.length;t--;){let i=this.renderers[t],a=i.getImage(),f=a.width,b=a.height,g=i.gameObject.transform.position.x,C=i.gameObject.transform.position.y;this.offscreenContext.drawImage(a,g,C,f,b)}this.displayContext.drawImage(this.offscreenCanvas,0,0,this.offscreenCanvas.width,this.offscreenCanvas.height)}clearScreen(){this.offscreenContext.fillRect(0,0,this.displayCanvas.width,this.displayCanvas.height)}};var m=class{constructor(e){e!==void 0&&(this.image=e),r.getInstance().addRenderer(this)}start(){}update(e){}getImage(){return this.image}setImage(e){this.image=e}};var s=class{constructor(){this.gameObjects=new Array}static getInstance(){return s.instance||(s.instance=new s),s.instance}addGameObject(e){this.gameObjects.indexOf(e)==-1&&this.gameObjects.push(e)}update(e){for(let t=this.gameObjects.length;t--;)this.gameObjects[t].update(e)}};var n=class{constructor(e,t){this.x=0;this.y=0;e!==void 0&&(this.x=e),t!==void 0&&(this.y=t)}add(e){return e instanceof n?new n(this.x+e.x,this.y+e.y):new n(this.x+e,this.y+e)}subtract(e){return e instanceof n?new n(this.x-e.x,this.y-e.y):new n(this.x-e,this.y-e)}multiply(e){return e instanceof n?new n(this.x*e.x,this.y*e.y):new n(this.x*e,this.y*e)}static addVectors(e,t){return new n(e.x+t.x,e.y+t.y)}static subtractVectors(e,t){return new n(e.x-t.x,e.y-t.y)}static multiplyVectors(e,t){return new n(e.x*t.x,e.y*t.y)}static distance(e,t){return n.len(n.subtractVectors(e,t))}static normalize(e){let t=n.len(e);return new n(e.x/t,e.y/t)}static len(e){return Math.sqrt(e.x*e.x+e.y*e.y)}};var p=class{constructor(e,t,i){this.position=new n;this.isMoving=!1;e!==void 0&&(this.position.x=e),t!==void 0&&(this.position.y=t),i!==void 0&&(this.position=i)}start(){}update(e){this.isMoving&&(this.position=n.addVectors(this.position,this.direction.multiply(this.speed*e)),n.distance(this.startPosition,this.position)>=this.distance&&(this.position=this.endPosition,this.isMoving=!1))}moveTo(e,t){this.startPosition=this.position,this.endPosition=e,this.distance=n.distance(this.startPosition,e),this.speed=t/1e3,this.direction=n.normalize(n.subtractVectors(e,this.startPosition)),this.isMoving=!0}};var d=class{constructor(e){this.components=new Array;s.getInstance().addGameObject(this),this.transform=this.addComponent(new p),this.name=e||"New GameObject",this.start()}start(){console.log("Started",this.name)}update(e){for(let t=this.components.length;t--;)this.components[t].update(e)}addComponent(e){let t=e;return t.gameObject=this,this.components.indexOf(t)==-1?(this.components.push(t),t.start(),e):null}getComponent(e){for(let t=this.components.length;t--;){let i=this.components[t];if(i instanceof e)return i}return null}removeComponent(e){let t=-1;for(let i=this.components.length;i--;)this.components[i]==e&&(t=i);t!=-1&&this.components.splice(t,1)}};var v=s.getInstance(),y=r.getInstance(),c=.01,h=performance.now(),u=0;function w(){let o=new d("Player"),e=new Image;e.src="./src/assets/player.png",o.addComponent(new m(e)),window.requestAnimationFrame(l)}function l(){let o=performance.now(),e=o-h;for(h=o,u+=e;u>=c;)v.update(c),u-=c;y.update(c),window.requestAnimationFrame(l)}window.onload=()=>w();})();
//# sourceMappingURL=game.js.map
