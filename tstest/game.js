(()=>{var s=class{constructor(){}start(){document.addEventListener("keydown",e=>{e.defaultPrevented||s.pressedKeys.indexOf(e.code)==-1&&s.pressedKeys.push(e.code)}),document.addEventListener("keyup",e=>{if(e.defaultPrevented)return;let t=s.pressedKeys.indexOf(e.code);t!=-1&&s.pressedKeys.splice(t,1)})}static getInstance(){return s.instance||(s.instance=new s),s.instance}static keyDown(e){return this.pressedKeys.indexOf(e)!=-1}},i=s;i.pressedKeys=new Array;var d=class{constructor(){this.speed=1}start(){}update(e){(i.keyDown("KeyA")||i.keyDown("ArrowLeft"))&&(this.gameObject.transform.position.x-=this.speed*e),(i.keyDown("KeyD")||i.keyDown("ArrowRight"))&&(this.gameObject.transform.position.x+=this.speed*e),(i.keyDown("KeyW")||i.keyDown("ArrowUp"))&&(this.gameObject.transform.position.y-=this.speed*e),(i.keyDown("KeyS")||i.keyDown("ArrowDown"))&&(this.gameObject.transform.position.y+=this.speed*e)}};var o=class{constructor(){this.renderers=new Array}start(){this.displayCanvas=document.querySelector("#canvas"),this.offscreenCanvas=document.createElement("canvas"),this.offscreenCanvas.width=this.displayCanvas.width,this.offscreenCanvas.height=this.displayCanvas.height,this.displayContext=this.displayCanvas.getContext("2d"),this.offscreenContext=this.offscreenCanvas.getContext("2d")}static getInstance(){return o.instance||(o.instance=new o),o.instance}addRenderer(e){this.renderers.indexOf(e)==-1&&this.renderers.push(e)}update(e){this.clearScreen();for(let t=this.renderers.length;t--;){let r=this.renderers[t],m=r.image,v=m.width,C=m.height,x=r.gameObject.transform.position.x,j=r.gameObject.transform.position.y;this.offscreenContext.drawImage(m,x,j,v,C)}this.displayContext.drawImage(this.offscreenCanvas,0,0,this.offscreenCanvas.width,this.offscreenCanvas.height)}clearScreen(){this.offscreenContext.fillRect(0,0,this.displayCanvas.width,this.displayCanvas.height)}};var u=class{constructor(e){e!==void 0&&(this.image=e),o.getInstance().addRenderer(this)}start(){}update(e){}};var a=class{constructor(){this.gameObjects=new Array}start(){}static getInstance(){return a.instance||(a.instance=new a),a.instance}addGameObject(e){this.gameObjects.indexOf(e)==-1&&this.gameObjects.push(e)}update(e){for(let t=this.gameObjects.length;t--;)this.gameObjects[t].update(e)}};var n=class{constructor(e,t){this.x=0;this.y=0;e!==void 0&&(this.x=e),t!==void 0&&(this.y=t)}add(e){return e instanceof n?new n(this.x+e.x,this.y+e.y):new n(this.x+e,this.y+e)}subtract(e){return e instanceof n?new n(this.x-e.x,this.y-e.y):new n(this.x-e,this.y-e)}multiply(e){return e instanceof n?new n(this.x*e.x,this.y*e.y):new n(this.x*e,this.y*e)}static addVectors(e,t){return new n(e.x+t.x,e.y+t.y)}static subtractVectors(e,t){return new n(e.x-t.x,e.y-t.y)}static multiplyVectors(e,t){return new n(e.x*t.x,e.y*t.y)}static distance(e,t){return n.len(n.subtractVectors(e,t))}static normalize(e){let t=n.len(e);return new n(e.x/t,e.y/t)}static len(e){return Math.sqrt(e.x*e.x+e.y*e.y)}};var l=class{constructor(e,t,r){this.position=new n;this.isMoving=!1;e!==void 0&&(this.position.x=e),t!==void 0&&(this.position.y=t),r!==void 0&&(this.position=r)}start(){}update(e){this.isMoving&&(this.position=n.addVectors(this.position,this.direction.multiply(this.speed*e)),n.distance(this.startPosition,this.position)>=this.distance&&(this.position=this.endPosition,this.isMoving=!1))}moveTo(e,t){this.startPosition=this.position,this.endPosition=e,this.distance=n.distance(this.startPosition,e),this.speed=t/1e3,this.direction=n.normalize(n.subtractVectors(e,this.startPosition)),this.isMoving=!0}};var h=class{constructor(e){this.components=new Array;a.getInstance().addGameObject(this),this.transform=this.addComponent(new l),this.name=e||"New GameObject",this.start()}start(){console.log("Started",this.name)}update(e){for(let t=this.components.length;t--;)this.components[t].update(e)}addComponent(e){let t=e;return t.gameObject=this,this.components.indexOf(t)==-1?(this.components.push(t),t.start(),e):null}getComponent(e){for(let t=this.components.length;t--;){let r=this.components[t];if(r instanceof e)return r}return null}removeComponent(e){let t=-1;for(let r=this.components.length;r--;)this.components[r]==e&&(t=r);t!=-1&&this.components.splice(t,1)}};var b=a.getInstance(),y=o.getInstance(),O=i.getInstance(),p=.01,g=performance.now(),f=0;function I(){b.start(),y.start(),O.start();let c=new h("Player"),e=c.addComponent(new u),t=new Image;t.src="src/assets/player.png",e.image=t,c.addComponent(new d),window.requestAnimationFrame(w)}function w(){let c=performance.now(),e=c-g;for(g=c,f+=e;f>=p;)b.update(p),f-=p;y.update(p),window.requestAnimationFrame(w)}window.onload=()=>I();})();
//# sourceMappingURL=game.js.map
